import pandas as pd
import json
def specific_provider(in_out, num, df, data):
    for i in range(1, num):
        for j in data[in_out + "patient Payer Specific Charge " + str(i)]:
            try:
                temp = ["Legacy Good Samaritan Medical Center", j["MS-DRG"], -1,"MS-DRG", j["Description"], j["Payer"], j["Payer Specific Negotiated Charge"]]
            except:
                temp = ["Legacy Good Samaritan Medical Center", j["APC"], -1, "APC", j["Description"], j["Payer"], j["Payer Specific Negotiated Charge"]]
            df.loc[len(df)] = temp
    return df
def min_max(minmax, in_out, df,data):
    for i in data[in_out+"patient De-identified " +minmax +"imum Negotiated Charge"]:
        try:
            temp = ["Legacy Good Samaritan Medical Center", i["MS-DRG"], -1,"MS-DRG", i["Description"], minmax + "imum " + in_out + "patient Charge", i["De-Identified "+  minmax +"imum Negotiated Charge"]]
        except:
            print(i)
            temp = ["Legacy Good Samaritan Medical Center", i["APC"], -1, "APC", i["Description"], minmax + "imum " + in_out + "patient Charge", i["De-Identified " + minmax + "imum Negotiated Charge"]]
        df.loc[len(df)] = temp
    return df
def gross(data, df, affil, addendum):
    for i in data["Gross Charges"]:
        print("Testing")
        try:
            temp = ["Legacy Good Samaritan Medical Center", i["CDM Revenue Code"], i["CDM Hcpcs"],"CDM Revenue Code", i["Description"],  affil + "Price" , i["LEGACY GOOD SAMARITAN MEDICAL CENTER"+addendum]]
        except:
             temp = ["Legacy Good Samaritan Medical Center", i["CDM Revenue Code"], -1 ,"CDM Revenue Code", i["Description"], affil+  "Price" , i["LEGACY GOOD SAMARITAN MEDICAL CENTER"+ addendum]]
        df.loc[len(df)] = temp
    return df
def main():
    with open('legacy_good_samaritan_medical_center_standardcharges.json','r') as file:
        data = json.load(file)
    df = pd.DataFrame(columns = ['Hospital', 'Procedure Code' ,'HCPCS', 'Code Code', 'Procedure Name', 'Affiliation' , 'Cost'])
    #print(data.keys())
    gross(data, df, "Normal ", "")
    gross(data, df, "Discounted Cash ", " Discount Cash Price")
    min_max("Min","In", df, data)
    min_max("Max","In", df, data)
    min_max("Min", "Out", df, data)
    min_max("Max", "Out", df, data)
    
    
    
    specific_provider("In" , 41, df, data)
    specific_provider("Out", 44,df,data)
    #print(df)
    #df.to_csv("legacy_good_samaritan_medical_center_standardcharges.csv")
main()
